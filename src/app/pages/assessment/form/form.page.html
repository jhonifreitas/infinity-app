<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="isBeginning ? goToBack() : prev()">
        <ion-icon slot="icon-only" name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>{{ assessment?.name }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-progress-bar *ngIf="showingQuestion && !showSuccess" [value]="percentage"></ion-progress-bar>

  <ion-slides #slides [scrollbar]="true" [options]="slideOpts" (ionSlideDidChange)="slideChanged()" *ngIf="!showSuccess">
    <ion-slide *ngFor="let instruction of assessment?._instructions">

      <div [innerHtml]="instruction.text"></div>

    </ion-slide>
    <ion-slide *ngFor="let question of assessment?._questions; index as i">

      <ion-item lines="none" class="question">
        <ion-note slot="start">{{ i + 1 }}</ion-note>
        <ion-label class="ion-text-wrap" [innerHtml]="question.text"></ion-label>
      </ion-item>

      <!-- NEURO -->
      <ng-container *ngIf="question.type === 'neuro' && controls?.neuro">
        <ng-container [formGroup]="formGroup">
          <form formGroupName="neuro">
            <ion-radio-group class="neuro" formControlName="satisfaction">
              <ion-row>
                <ion-col size="3">
                  <ion-item button lines="none">
                    <ion-label>
                      <ion-icon name="sad"></ion-icon>
                      <ion-radio [value]="1"></ion-radio>
                    </ion-label>
                  </ion-item>
                </ion-col>
                <ion-col size="3">
                  <ion-item button lines="none">
                    <ion-label>
                      <ion-icon name="sad"></ion-icon>
                      <ion-radio [value]="2"></ion-radio>
                    </ion-label>
                  </ion-item>
                </ion-col>
                <ion-col size="3">
                  <ion-item button lines="none">
                    <ion-label>
                      <ion-icon name="happy"></ion-icon>
                      <ion-radio [value]="3"></ion-radio>
                    </ion-label>
                  </ion-item>
                </ion-col>
                <ion-col size="3">
                  <ion-item button lines="none">
                    <ion-label>
                      <ion-icon name="happy"></ion-icon>
                      <ion-radio [value]="4"></ion-radio>
                    </ion-label>
                  </ion-item>
                </ion-col>
              </ion-row>
            </ion-radio-group>
            
            <ion-radio-group class="neuro" formControlName="intensity">
              <ion-row>
                <ion-col size="3">
                  <ion-item button lines="none">
                    <ion-label>
                      <ion-icon name="stats-chart"></ion-icon>
                      <ion-radio [value]="1"></ion-radio>
                    </ion-label>
                  </ion-item>
                </ion-col>
                <ion-col size="3">
                  <ion-item button lines="none">
                    <ion-label>
                      <ion-icon name="stats-chart"></ion-icon>
                      <ion-radio [value]="2"></ion-radio>
                    </ion-label>
                  </ion-item>
                </ion-col>
                <ion-col size="3">
                  <ion-item button lines="none">
                    <ion-label>
                      <ion-icon name="stats-chart"></ion-icon>
                      <ion-radio [value]="3"></ion-radio>
                    </ion-label>
                  </ion-item>
                </ion-col>
                <ion-col size="3">
                  <ion-item button lines="none">
                    <ion-label>
                      <ion-icon name="stats-chart"></ion-icon>
                      <ion-radio [value]="4"></ion-radio>
                    </ion-label>
                  </ion-item>
                </ion-col>
              </ion-row>
            </ion-radio-group>
          </form>
        </ng-container>
      </ng-container>

      <!-- OBJECTIVE -->
      <ng-container *ngIf="question.type === 'objective' && controls?.alternativeId">
        <form [formGroup]="formGroup">
          <ion-radio-group formControlName="alternativeId">
            <ion-item lines="none" *ngFor="let alternative of question.alternatives; index as alternativeId">
              <ion-radio slot="start" class="ion-margin-end" [value]="alternativeId"></ion-radio>
              <ion-label class="ion-text-wrap">{{ alternative.text }}</ion-label>
            </ion-item>
          </ion-radio-group>
        </form>
      </ng-container>

      <!-- OBJECTIVE -->
      <ng-container *ngIf="question.type === 'dissertation' && controls?.text">
        <form [formGroup]="formGroup">
          <ion-item>
            <ion-label position="floating">Resposta</ion-label>
            <ion-textarea rows="6" formControlName="text"></ion-textarea>
          </ion-item>
        </form>
      </ng-container>
    </ion-slide>
  </ion-slides>

  <div id="vertical-align" *ngIf="showSuccess">
    <div class="container ion-text-center">
      <h2>Obrigado por suas respostas</h2>
      <h2>Seu tempo de conclusão</h2>
    </div>
  </div>

</ion-content>

<ion-footer>
  <ion-button type="button" expand="block" color="dark" *ngIf="!showSuccess" (click)="next()">
    {{ activeIndex == assessment?._instructions.length - 1 ? 'Iniciar o Assessment' : ( isEnd ? 'Finalizar' : 'Avançar') }}
  </ion-button>

  <ion-button type="button" expand="block" color="dark" *ngIf="showSuccess" (click)="goToBack()">
    Sair
  </ion-button>
</ion-footer>